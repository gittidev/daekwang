{"file":"contact-Bu2g5Ud8.js","mappings":";;;;;;;;;;;;;;;;;;AAIgB,QAAI,EAAE;AAChB,UAAA,WAAW,IAAI,EAAE;AACjB,UAAA,WAAW,IAAI,EAAE;AACD,QAAI,EAAE;AACb,QAAI,EAAE;AACH,QAAI,EAAE;AAClB,UAAA,gBAAgB,IAAI,EAAE;AACtB,UAAAA,WAAU,IAAI,EAAE;AAChB,UAAA,gBAAgB,IAAI,EAAE;AAE5B,UAAM,aAAa,IAAwC;AAAA,MACzD,EAAE,MAAM,IAAI,QAAQ,GAAG;AAAA,IAAA,CACxB;;;;;;;;;;;;;;;;;","names":["contact"],"sources":["../../../../pages/contact.vue"],"sourcesContent":["<script setup lang=\"ts\">\r\nimport { ref } from \"vue\";\r\n\r\nconst emailAddress = \"pyw4733@hanmail.net\";\r\nconst subject = ref(\"\");\r\nconst location = ref(\"\");\r\nconst timeline = ref(\"\");\r\nconst specification = ref(\"\");\r\nconst length = ref(\"\");\r\nconst equipment = ref(\"\");\r\nconst otherRequests = ref(\"\");\r\nconst contact = ref(\"\");\r\nconst estimatedCost = ref(\"\");\r\n\r\nconst pcBoxSpecs = ref<{ spec: string; length: string }[]>([\r\n  { spec: \"\", length: \"\" },\r\n]);\r\n\r\nconst addSpec = () => {\r\n  pcBoxSpecs.value.push({ spec: \"\", length: \"\" });\r\n};\r\n\r\nconst removeSpec = (index: number) => {\r\n  pcBoxSpecs.value.splice(index, 1);\r\n};\r\n\r\nconst createAndDownloadExcel = async () => {\r\n  const { default: ExcelJS } = await import(\"exceljs\");\r\n  const module = await import(\"file-saver\");\r\n  const saveAs = module.default;\r\n\r\n  const workbook = new ExcelJS.Workbook();\r\n  const worksheet = workbook.addWorksheet(\"견적서\");\r\n\r\n  const titleStyle: Partial<import(\"exceljs\").Style> = {\r\n    font: { bold: true, size: 14, color: { argb: \"FFFFFF\" } },\r\n    alignment: { vertical: \"middle\", horizontal: \"center\" },\r\n    fill: { type: \"pattern\", pattern: \"solid\", fgColor: { argb: \"3182CE\" } },\r\n    border: {\r\n      top: { style: \"thin\" },\r\n      bottom: { style: \"thin\" },\r\n      left: { style: \"thin\" },\r\n      right: { style: \"thin\" },\r\n    },\r\n  };\r\n\r\n  const headerStyle: Partial<import(\"exceljs\").Style> = {\r\n    font: { bold: true, size: 12, color: { argb: \"FFFFFF\" } },\r\n    alignment: { vertical: \"middle\", horizontal: \"center\" },\r\n    fill: { type: \"pattern\", pattern: \"solid\", fgColor: { argb: \"4A5568\" } },\r\n    border: {\r\n      top: { style: \"thin\" },\r\n      bottom: { style: \"thin\" },\r\n      left: { style: \"thin\" },\r\n      right: { style: \"thin\" },\r\n    },\r\n  };\r\n\r\n  const cellStyle: Partial<import(\"exceljs\").Style> = {\r\n    font: { size: 10 },\r\n    alignment: { vertical: \"middle\", horizontal: \"left\" },\r\n    border: {\r\n      top: { style: \"thin\" },\r\n      bottom: { style: \"thin\" },\r\n      left: { style: \"thin\" },\r\n      right: { style: \"thin\" },\r\n    },\r\n  };\r\n\r\n  worksheet.mergeCells(\"A1:B1\");\r\n  worksheet.getCell(\"A1\").value = `${location.value} 견적서`;\r\n  worksheet.getCell(\"A1\").style = titleStyle;\r\n\r\n  worksheet.columns = [\r\n    { key: \"A\", width: 20 },\r\n    { key: \"B\", width: 30 },\r\n  ];\r\n\r\n  worksheet\r\n    .addRow([\"이름/직책\", contact.value])\r\n    .eachCell((cell) => (cell.style = cellStyle));\r\n  worksheet\r\n    .addRow([\"연락처\", contact.value])\r\n    .eachCell((cell) => (cell.style = cellStyle));\r\n  worksheet\r\n    .addRow([\"시공 시기\", timeline.value])\r\n    .eachCell((cell) => (cell.style = cellStyle));\r\n  worksheet\r\n    .addRow([\"시공 장소\", location.value])\r\n    .eachCell((cell) => (cell.style = cellStyle));\r\n  worksheet.addRow([]);\r\n\r\n  worksheet\r\n    .addRow([\"PC 예상 시공 내역\", \"\"])\r\n    .eachCell((cell) => (cell.style = headerStyle));\r\n  worksheet.mergeCells(\"A6:B6\");\r\n\r\n  worksheet\r\n    .addRow([\"PC 박스 규격\", \"길이(M)\"])\r\n    .eachCell((cell) => (cell.style = headerStyle));\r\n  worksheet\r\n    .addRow([specification.value, length.value])\r\n    .eachCell((cell) => (cell.style = cellStyle));\r\n  pcBoxSpecs.value.forEach((item) => {\r\n    worksheet\r\n      .addRow([item.spec, item.length])\r\n      .eachCell((cell) => (cell.style = cellStyle));\r\n  });\r\n\r\n  worksheet.addRow([]);\r\n\r\n  worksheet\r\n    .addRow([\"장비 지원 여부\", equipment.value])\r\n    .eachCell((cell) => (cell.style = cellStyle));\r\n  worksheet\r\n    .addRow([\"기타 요청 사항\", otherRequests.value])\r\n    .eachCell((cell) => (cell.style = cellStyle));\r\n\r\n  const buffer = await workbook.xlsx.writeBuffer();\r\n  const blob = new Blob([buffer], {\r\n    type: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\",\r\n  });\r\n  saveAs(blob, `${location.value}_견적서.xlsx`);\r\n};\r\n\r\nconst openEmailClient = () => {\r\n  let mailBody = `다음 세부사항이 포함된 견적을 제공해 주세요:\r\n- 시공 장소: ${location.value}\r\n- 시공 시기: ${timeline.value}\r\n- 장비 지원 여부: ${equipment.value}\r\n- 기타 요청: ${otherRequests.value}`;\r\n\r\n  pcBoxSpecs.value.forEach((item, index) => {\r\n    mailBody += `\\nPC 박스 ${index + 1} 규격: ${item.spec}   설치 길이: ${\r\n      item.length\r\n    }`;\r\n  });\r\n\r\n  subject.value = `${location.value} 견적 요청드립니다`;\r\n\r\n  const mailtoLink = `mailto:${emailAddress}?subject=${encodeURIComponent(\r\n    subject.value\r\n  )}&body=${encodeURIComponent(mailBody)}`;\r\n  window.location.href = mailtoLink;\r\n};\r\n</script>\r\n\r\n<template>\r\n  <div class=\"container\">\r\n    <div class=\"contact-content\">\r\n      <div class=\"info-section\">\r\n        <h2>견적 요청</h2>\r\n        <p>아래 정보를 입력해 주세요.</p>\r\n\r\n        <!-- 시공 장소 -->\r\n        <div class=\"form-group\">\r\n          <label>시공 장소</label>\r\n          <input v-model=\"location\" placeholder=\"전라남도 나주시\" />\r\n        </div>\r\n\r\n        <!-- 시공 시기 -->\r\n        <div class=\"form-group\">\r\n          <label>시공 시기</label>\r\n          <input v-model=\"timeline\" placeholder=\"2025년 3월\" />\r\n        </div>\r\n\r\n        <!-- 연락처 -->\r\n        <div class=\"form-group\">\r\n          <label>연락처</label>\r\n          <input v-model=\"contact\" placeholder=\"010-1234-5678\" />\r\n        </div>\r\n\r\n        <!-- 예상 시공 견적비용 -->\r\n        <div class=\"form-group\">\r\n          <label>예상 시공 견적비용</label>\r\n          <input v-model=\"estimatedCost\" placeholder=\"100,000 원\" />\r\n        </div>\r\n\r\n        <!-- PC 박스 규격 및 설치 길이 (동적 추가) -->\r\n        <div class=\"form-group\">\r\n          <label>PC 박스 규격 및 설치 길이</label>\r\n          <div\r\n            v-for=\"(item, index) in pcBoxSpecs\"\r\n            :key=\"index\"\r\n            class=\"pc-box-entry\"\r\n          >\r\n            <input\r\n              v-model=\"item.spec\"\r\n              placeholder=\"300x200x150mm\"\r\n              class=\"input-spec\"\r\n            />\r\n            <input\r\n              v-model=\"item.length\"\r\n              placeholder=\"50m\"\r\n              class=\"input-length\"\r\n            />\r\n            <button @click=\"removeSpec(index)\" class=\"remove-btn\">❌</button>\r\n          </div>\r\n          <button @click=\"addSpec\" class=\"add-btn\">+ 항목 추가</button>\r\n        </div>\r\n\r\n        <!-- 기타 요청 -->\r\n        <div class=\"form-group\">\r\n          <label>기타 요청 사항</label>\r\n          <textarea\r\n            v-model=\"otherRequests\"\r\n            placeholder=\"기타 요청 사항을 작성해 주세요.\"\r\n          ></textarea>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 엑셀 다운로드 버튼 -->\r\n      <button class=\"contact-button\" @click=\"createAndDownloadExcel\">\r\n        엑셀 파일 다운로드\r\n      </button>\r\n\r\n      <!-- 이메일 전송 버튼 -->\r\n      <button class=\"contact-button\" @click=\"openEmailClient\">\r\n        견적 요청 이메일 전송\r\n      </button>\r\n    </div>\r\n  </div>\r\n</template>\r\n<style scoped>\r\n/* 기본 컨테이너 */\r\n.container {\r\n  max-width: 800px;\r\n  margin: 2rem auto;\r\n  padding: 2rem;\r\n  background-color: #f0f0f0;\r\n  min-height: 100vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n}\r\n\r\n/* 입력 폼 */\r\n.contact-content {\r\n  width: 100%;\r\n  padding: 1.5rem;\r\n  background: white;\r\n  border-radius: 8px;\r\n  border: 1px solid #d1d5db;\r\n  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n/* 제목 */\r\nh2 {\r\n  color: #2d3748;\r\n  font-size: 1.5rem;\r\n  font-weight: 600;\r\n  margin-bottom: 1.25rem;\r\n  text-align: center;\r\n}\r\n\r\n/* 부제목 */\r\np {\r\n  color: #718096;\r\n  font-size: 1rem;\r\n  margin-bottom: 1.5rem;\r\n  text-align: center;\r\n}\r\n\r\n/* 입력 필드 스타일 */\r\n.form-group {\r\n  margin: 1rem 0;\r\n}\r\n\r\nlabel {\r\n  display: block;\r\n  color: #2d3748;\r\n  font-size: 0.95rem;\r\n  font-weight: 500;\r\n  margin-bottom: 0.5rem;\r\n}\r\n\r\ninput,\r\ntextarea {\r\n  width: 100%;\r\n  padding: 0.75rem;\r\n  border: 1px solid #d1d5db;\r\n  border-radius: 6px;\r\n  background-color: #fafafa;\r\n  font-size: 1rem;\r\n  color: #4a5568;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\ninput:focus,\r\ntextarea:focus {\r\n  border-color: #3182ce;\r\n  outline: none;\r\n  box-shadow: 0 0 0 2px rgba(50, 144, 221, 0.3);\r\n}\r\n\r\n/* 버튼 스타일 */\r\n.contact-button {\r\n  width: 100%;\r\n  padding: 0.75rem;\r\n  background-color: #3182ce;\r\n  color: white;\r\n  font-size: 1rem;\r\n  font-weight: 600;\r\n  border: none;\r\n  border-radius: 6px;\r\n  cursor: pointer;\r\n  margin: 0.5rem 0;\r\n  transition: background-color 0.3s ease, transform 0.2s ease;\r\n}\r\n\r\n.contact-button:hover {\r\n  background-color: #2b6cb0;\r\n  transform: translateY(-2px);\r\n}\r\n\r\n.contact-button:active {\r\n  transform: translateY(0);\r\n}\r\n\r\n/* 추가/삭제 버튼 */\r\n.add-btn,\r\n.remove-btn {\r\n  margin-top: 1rem;\r\n  padding: 0.5rem 1rem;\r\n  background-color: #f6ad55;\r\n  color: white;\r\n  border-radius: 6px;\r\n  border: none;\r\n  cursor: pointer;\r\n  font-weight: 600;\r\n}\r\n\r\n.remove-btn {\r\n  background-color: #e53e3e;\r\n}\r\n\r\n.add-btn:hover,\r\n.remove-btn:hover {\r\n  background-color: #dd6b20;\r\n}\r\n\r\n/* 항목 추가 필드 */\r\n.pc-box-entry {\r\n  display: flex;\r\n  gap: 1rem;\r\n  margin-top: 0.5rem;\r\n}\r\n\r\n.input-spec,\r\n.input-length {\r\n  flex: 1;\r\n  padding: 0.75rem;\r\n}\r\n\r\n/* 모바일 반응형 */\r\n@media (max-width: 600px) {\r\n  .container {\r\n    padding: 1rem;\r\n  }\r\n\r\n  .contact-content {\r\n    padding: 1.25rem;\r\n  }\r\n\r\n  h2 {\r\n    font-size: 1.25rem;\r\n  }\r\n\r\n  .form-group {\r\n    margin: 1rem 0;\r\n  }\r\n\r\n  input,\r\n  textarea {\r\n    font-size: 0.95rem;\r\n  }\r\n\r\n  .contact-button {\r\n    padding: 0.75rem;\r\n    margin: 0.5rem 0;\r\n    font-size: 1rem;\r\n  }\r\n}\r\n</style>\r\n"],"version":3}