import{c as h,a as r,u as _,d as w,A as b,G as y,b as k,g as t,e as x,i as g,v as f,o as T,_ as A}from"./CzpvF0SR.js";import{u as I}from"./yF3l_Q4x.js";import{u as C}from"./BrDmpX_n.js";const E="admin_token",L=()=>{const a=C(E),l=h(()=>!!a.value),o=r(!1),n=r(null),d=_();return{token:a,isLoggedIn:l,login:async(u,e)=>{var s;try{o.value=!0,n.value=null;const i=await fetch(`${d.public.apiUrl}/admin/login`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:u,password:e})});if(!i.ok)throw new Error("로그인에 실패했습니다.");const m=await i.json(),v=((s=m.data)==null?void 0:s.access_token)||null;return a.value=v,m}catch(i){throw n.value=i.message||"알 수 없는 오류",i}finally{o.value=!1}},logout:()=>{a.value=null},loading:o,error:n}},M={class:"login-page"},N={class:"login-container"},B=w({__name:"index",setup(a){const l=r(""),o=r(""),n=y(),{login:d}=L(),{isLoggedIn:c}=I();b(()=>{console.log("isLoggedIn"),c.value&&n.push("/admin/dashboard")});const p=async()=>{try{const u=await d(l.value,o.value);n.push("/admin/dashboard")}catch{alert("로그인에 실패했습니다. 아이디 또는 비밀번호를 확인하세요.")}};return(u,e)=>(T(),k("div",M,[t("div",N,[e[3]||(e[3]=t("h2",null,"관리자 로그인",-1)),t("form",{onSubmit:x(p,["prevent"]),class:"login-form"},[g(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>l.value=s),placeholder:"아이디",class:"input-field"},null,512),[[f,l.value]]),g(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>o.value=s),type:"password",placeholder:"비밀번호",class:"input-field"},null,512),[[f,o.value]]),e[2]||(e[2]=t("button",{type:"submit",class:"login-button"},"로그인",-1))],32)])]))}}),V=A(B,[["__scopeId","data-v-005fe0b7"]]);export{V as default};
